<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>BikeMap Dublin</title>
    <link rel="stylesheet" href="./css/dublinbike.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC0c_tPCFVOTqCfC6hbjakRu2fHYEHA3_8"></script>
    <script src="./js/dublinbike.js" defer></script>

    <!-- Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-auth.js";

        // 🔥 Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBzclffq1g197mt6lwqxYl_s-KYd5quzDA",
            authDomain: "dublinbike-e7b00.firebaseapp.com",
            projectId: "dublinbike-e7b00",
            storageBucket: "dublinbike-e7b00.firebasestorage.app",
            messagingSenderId: "921855682206",
            appId: "1:921855682206:web:0fa098c3e8b75bc9a23d8f",
            measurementId: "G-HTNX219YE4"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Monitor user login status
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById("user-info").innerHTML = `
                    <img src="${user.photoURL || 'images/default-avatar.png'}" alt="User Avatar" class="user-avatar">
                    <span class="user-name">${user.displayName}</span>
                    <button id="logout-btn" class="logout-btn">Logout</button>
                `;
                document.getElementById("logout-btn").addEventListener("click", function () {
                    signOut(auth).then(() => {
                        window.location.href = "login.html"; // Redirect to login page after logout
                    }).catch((error) => console.error("Logout failed:", error));
                });
            } else {
                window.location.href = "login.html"; // Redirect to login if not authenticated
            }
        });
    </script>
</head>

<body>
<header>
    <div class="header-container">
        <h1>BikeMap Dublin</h1>
        <img src="./images/dublinbikes_logo.png" alt="Dublin Bikes Logo" class="logo">
        <div id="user-info" class="user-container"></div>  <!-- 🔥 User Info Display -->
    </div>
</header>

<div class="main-container">
    <!-- 📌 Sidebar -->
    <div class="sidebar">
        <h2>Station & Weather Details</h2>

        <!-- 📍 Station Detail Card -->
        <div id="stationDetail" class="detail-card">
            <h3>Station Details</h3>
            <p>Select a station on the map to view details.</p>
        </div>

        <!-- 🌤️ Weather Info Card -->
        <div id="weatherInfo" class="detail-card">
            <h3>Dublin Weather</h3>
            <p><strong>🌡️ Temperature:</strong> <span id="temp">Loading...</span></p>
            <p><strong>🤔 Feels Like:</strong> <span id="tempFeel">Loading...</span></p>
            <p><strong>🌥️ Condition:</strong> <span id="condition">Loading...</span></p>
            <p><strong>💨 Wind Speed:</strong> <span id="wind">Loading...</span></p>
            <p><strong>☁️ Cloud Coverage:</strong> <span id="clouds">Loading...</span></p>
            <p><strong>🌅 Sunrise:</strong> <span id="sunrise">Loading...</span></p>
            <p><strong>🌇 Sunset:</strong> <span id="sunset">Loading...</span></p>
        </div>
    </div>

    <!-- 🗺️ Map Container -->
    <div class="map-container">
        <div id="map"></div>
    </div>
</div>
</body>

</html>
